(()=>{"use strict";const t="http://127.0.0.1:8000/api/";document.addEventListener("DOMContentLoaded",(function(){!async function(){const o=await async function(){const o=t;try{const t=sessionStorage.getItem("token"),e=await fetch(o+"lotes",{headers:{Authorization:"Bearer "+t}});if(e.ok)return(await e.json()).lotes;console.log("Algo fue mal")}catch(t){console.error("Error al obtener los lotes:",t)}}(),e=$("#example").DataTable();e.clear().draw(),o.forEach((o=>{const n=e.row.add([o.id_lote,o.latitud,o.longitud,o.estado,"Enviado"==o.estado?`<button class="btn btn-danger btn-sm" data-bs-toggle="modal" data-bs-target="#deleteModal${o.id_lote}"> <i class="fas fa-times"></i> Cancelar</button>`:""]).draw(),a=`\n            <div class="modal" id="deleteModal${o.id_lote}">\n            <div class="modal-dialog modal-md">\n                <div class="modal-content">\n        \n                    <div class="modal-header">\n                        <h4 class="modal-title">Confirmar cancelación</h4>\n                        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>\n                    </div>\n        \n        \n                    <div class="modal-body">\n                        <p>¿Estás seguro de que deseas cancelar este lote?</p>\n                    </div>\n        \n                    <div class="modal-footer">\n                        <button type="button" class="btn btn-danger" data-bs-dismiss="modal" id="confirmarEliminacionBtn${o.id_lote}">Confirmar cancelación</button>\n                    </div>\n        \n                </div>\n            </div>\n        </div>`;document.body.insertAdjacentHTML("beforeend",a),n.nodes().to$().data("lote",o),async function(o){const e=document.getElementById(`confirmarEliminacionBtn${o}`);e&&e.addEventListener("click",(async()=>{try{await async function(o){const e=t;try{const t=sessionStorage.getItem("token"),n=await fetch(e+"lotes/"+o,{method:"DELETE",headers:{Authorization:"Bearer "+t}});if(n.ok){const t=await n.json();console.log("Lote eliminado correctamente:",t)}else console.error("No se pudo eliminar el lote")}catch(t){console.error("Error al eliminar el lote:",t)}}(o);const e=document.getElementById(`deleteModal${o}`);new bootstrap.Modal(e).hide()}catch(t){console.error("Error al confirmar la eliminación:",t)}}))}(o.id_lote)}))}()}))})();